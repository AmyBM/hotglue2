$(document).ready(function(){$.glue.grid.x($.glue.conf.page.default_grid_x);$.glue.grid.y($.glue.conf.page.default_grid_y);for(i in $.glue.conf.page.guides_x){$.glue.grid.add_guide_x($.glue.conf.page.guides_x[i])}for(i in $.glue.conf.page.guides_y){$.glue.grid.add_guide_y($.glue.conf.page.guides_y[i])}var a;a=$('<img src="'+$.glue.base_url+'modules/page/page-new.png" alt="btn" title="create a new page" width="32" height="32">');$(a).bind("click",function(c){$.glue.menu.hide();var b=prompt("Name the page to be created");if(b===null){return}$.glue.backend({method:"glue.create_page",page:b+".head"},function(d){window.location=$.glue.base_url+"?"+b+"/edit"})});$.glue.menu.register("page",a);a=$('<img src="'+$.glue.base_url+'modules/page/page-title.png" alt="btn" title="change page title" width="32" height="32">');$(a).bind("click",function(b){var c=$("title").html();c=prompt("Change the page title",c);if(c===null){return}$("title").html(c);$.glue.backend({method:"glue.update_object",name:$.glue.page+".page","page-title":c})});$.glue.menu.register("page",a);a=$('<img src="'+$.glue.base_url+'img/background-color.png" alt="btn" title="change the background color" width="32" height="32">');$(a).bind("click",function(c){var b=$("html").css("background-color");if(c.shiftKey){b=prompt("Enter background color (e.g. #ff0000 or rgb(255, 0, 0))",b);if(!b){return}}$.glue.colorpicker.show(b,false,function(d){$("html").css("background-color",d)},function(d){$.glue.grid.update(true);$.glue.backend({method:"glue.update_object",name:$.glue.page+".page","page-background-color":d})});$.glue.menu.hide()});$.glue.menu.register("page",a);a=$('<img src="'+$.glue.base_url+'modules/page/page-grid.png" width="32" height="32">');$(a).attr("title","show/hide grid or change grid size by dragging ("+$.glue.grid.x()+"x"+$.glue.grid.y()+")");$(a).bind("mousedown",function(c){var b=this;$.glue.slider(c,function(d,g,e){if(e.shiftKey){if(d<g){d=g}else{g=d}}var f=false;if(10<=Math.abs(d)){$.glue.grid.mode(1);$.glue.grid.x(Math.abs(d));f=true}if(10<=Math.abs(g)){$.glue.grid.mode(1);$.glue.grid.y(Math.abs(g));f=true}if(f){$.glue.grid.update(true)}},function(d,e){if(Math.abs(d)<10&&Math.abs(e)<10){if($.glue.grid.mode()){$.glue.grid.mode(0)}else{$.glue.grid.mode(1)}$.glue.grid.update()}$.glue.backend({method:"page.set_grid",x:$.glue.grid.x(),y:$.glue.grid.y()});$(b).attr("title","show/hide grid or change grid size by dragging ("+$.glue.grid.x()+"x"+$.glue.grid.y()+")");$.glue.menu.hide()});return false});$.glue.menu.register("page",a);a=$('<img src="'+$.glue.base_url+'modules/page/page-delete.png" alt="btn" title="delete page" width="32" height="32">');$(a).bind("click",function(d){if(confirm("Really delete the current page and all it's revisions?")){var c=$.glue.page.split(".").shift();var b=[];$.glue.backend({method:"glue.revisions",pagename:c},function(g){for(var e in g){b.push(c+"."+g[e])}for(var f in b){$.glue.backend({method:"glue.delete_page",page:b[f]})}window.location=$.glue.base_url+"?pages"})}$.glue.menu.hide()});$.glue.menu.register("page",a);a=$('<img src="'+$.glue.base_url+'modules/page/page-url.png" alt="btn" title="change the page&#039;s url" width="32" height="32">');$(a).bind("click",function(d){var b=$.glue.page.split(".").shift();var c=prompt("Change the page URL",b);if(c!=null&&c!=b){$.glue.backend({method:"glue.rename_page",old:b,"new":c},function(e){window.location=$.glue.base_url+"?"+c+"/edit"})}$.glue.menu.hide()});$.glue.menu.register("page",a);a=$('<img src="'+$.glue.base_url+'modules/page/page-set-startpage.png" alt="btn" title="make this the start page" width="32" height="32">');$(a).bind("click",function(b){$.glue.backend({method:"glue.set_startpage",page:$.glue.page});$.glue.menu.hide()});$.glue.menu.register("page",a)});
